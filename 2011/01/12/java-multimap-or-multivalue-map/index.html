<!DOCTYPE html>
<html>
        <head>
    <title>Java MultiMap or MultiValue Map</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="In my recent course work I found the need for wanting to have a key value type object which maps one key to multiple values.">
    <meta name="keywords" content="" />
    <script src="/js/jquery.min.js"></script>
    <script src="/js/init.js"></script>

    <link rel="stylesheet" href="/css/main.css">

    <link rel="canonical" href="//2011/01/12/java-multimap-or-multivalue-map">
    <link rel="alternate" type="application/atom+xml" title="zcourts AKA Courtney Robinson" href="/feed.xml" />
</head>
    <body>
        <!-- Header -->
<div id="header" class="skel-layers-fixed">

    <div class="top">

        <!-- Logo -->
        <div id="logo">
            <span class="image avatar48"><img src="/images/avatar.jpg" alt=""/></span>

            <h1 id="title">zcourts</h1>
            <p>Courtney Robinson</p>
            <p>Software Engineer</p>
            <p>PhD Student</p>
        </div>

        <!-- Nav -->
        <nav id="nav">
            <!--

                Prologue's nav expects links in one of two formats:

                1. Hash link (scrolls to a different section within the page)

                   <li><a href="#foobar" id="foobar-link" class="icon fa-whatever-icon-you-want skel-layers-ignoreHref"><span class="label">Foobar</span></a></li>

                2. Standard link (sends the user to another page/site)

                   <li><a href="http://foobar.tld" id="foobar-link" class="icon fa-whatever-icon-you-want"><span class="label">Foobar</span></a></li>

            -->
            <ul>
                <li><a href="/#top" id="top-link" class="skel-layers-ignoreHref"><span class="icon fa-home">Home</span></a></li>
                <li><a href="/#portfolio" id="portfolio-link" class="skel-layers-ignoreHref"><span class="icon fa-th">Projects</span></a></li>
                <li><a href="/posts" id="blog-link" class="skel-layers-ignoreHref"><span class=" glyphicon glyphicon-comment">Blog posts</span></a></li>
                <li><a href="/categories.html" id="cat-link" class="skel-layers-ignoreHref"><span class=" glyphicon glyphicon-tags">Categories</span></a></li>
                <li><a href="/about-courtney-robinson" id="about-link" class="skel-layers-ignoreHref"><span class="icon fa-user">About Me</span></a></li>
                <li><a href="/#contact" id="contact-link" class="skel-layers-ignoreHref"><span class="icon fa-envelope">Contact</span></a></li>
            </ul>
        </nav>

    </div>

    <div class="bottom">

        <!-- Social Icons -->
        <ul class="icons">
            <li><a href="https://twitter.com/zcourts" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
            <li><a href="https://www.facebook.com/zcourts" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
            <li><a href="https://github.com/zcourts" class="icon fa-github"><span class="label">Github</span></a></li>
            <li><a href="mailto:site@crlog.info" class="icon fa-envelope"><span class="label">Email</span></a></li>
        </ul>

    </div>

</div>
        <!-- Main -->
        <div id="main">
            <div class="post">

    <header class="post-header">
        <h1 class="post-title">Java MultiMap or MultiValue Map</h1>

        <p class="post-meta">Jan 12, 2011 â€¢ zcourts
            </p>
    </header>

    <article class="post-content">
        <p>In my recent course work I found the need for wanting to have a key value type object which maps one key to multiple values.</p>

<p>This could be easily accomplished in Java using a HashMap and a list or set. Doing HashMap would be very nice if you knew all the values you wanted to have mapped to the same key. Unfortunately, my use case wasn&#39;t that simple. And it wouldn&#39;t be very practical to manually maintain a reference to a list for each key.</p>

<p>I had to build a plugin framework in Java which allowed plugins to &quot;register&quot; for events. Multiple plugins could register for the same event and once that event had been queued for processing, all the handlers registered to listen for that event had to be notified.</p>

<p>A plugin could register and unregister which means the list of items to map an event to had to be dynamic, i.e must be able to add and remove items that a key points to. I came up with a solution as shown below, which worked out very nicely.
```java
package utils;</p>

<p>import java.io.Serializable;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Set;</p>

<p>/**
*
* @author Courtney
*/
public class MultiValue implements Cloneable, Serializable {</p>

<p>/**
* Keys stored as key:valueID
*/
private HashMap keys = new HashMap();
private HashMap&gt; values = new HashMap&gt;();</p>

<p>/**
* Adds a new value for the specified key
* @param key the key for the current value
* @param value the value to associate with this key
*/
public void put(K key, V value) {
ArrayList vals = new ArrayList();</p>

<p>//if the key already exist get the current list and add to it
if (this.containsKey(key)) {
int id = keys.get(key);
//get the existing items
vals = values.get(id);
//add the new item
vals.add(value);
//put the list back
values.put(id, vals);
} else {
//add the new item
vals.add(value);
int id = keys.size();
//if there is more than one item then add this item as size+1
// if(id==0)
id++;
values.put(id, vals);
keys.put(key, id);
}
}</p>

<p>/**
* @param key they key to get the values of
* @return a list of all values associated with the key
*/
public ArrayList get(K key) {
if (this.containsKey(key)) {
int id = keys.get(key);
return values.get(id);
}
return null;
}</p>

<p>/**
*
* @return the set of keys available
*/
public Set getKeySet() {
return keys.keySet();
}</p>

<p>/**
*
* @param key the key to check for
* @return true if the key exists and false otherwise
*/
public boolean containsKey(K key) {
return keys.containsKey(key);
}</p>

<p>public int size() {
return keys.size();
}</p>

<p>public Set keySet() {
return keys.keySet();
}
}</p>
<div class="highlight"><pre><code class="language-" data-lang="">


Using MultiValue is pretty simple,
```java
//using the magic of generics can be any combination of valid types
MultiValue registeredEvents = new MultiValue();
//this can be called multiple times, if the same key is used then all the items with the same key can
//be retrieved later
registeredEvents.put(key, value);
//if multiple values are stored then you simply iterate as normal
ArrayList handlers = registeredEvents.get(cmd);

</code></pre></div>
    </article>
    <footer class="post-footer">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'zcourts'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
    </footer>
</div>

        </div>
        <!-- Footer -->
<div id="footer">
    <!-- Copyright -->
    <ul class="copyright">
        <li><a href="http://zcourts.com">&copy; zcourts</a></li>
        <li>i.e. &copy; Courtney Robinson. All rights reserved.</li>
    </ul>

</div>
        <div class="addthis_toolbox addthis_default_style " id="addthisURL" addthis:url=""></div>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-46289473-4', 'auto');
            ga('require', 'linkid', 'linkid.js');
            ga('send', 'pageview');
            document.getElementById("addthisURL").setAttribute("addthis:url",window.location.href);
        </script>
        <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=zcourts" async="async"></script>
    </body>
</html>
